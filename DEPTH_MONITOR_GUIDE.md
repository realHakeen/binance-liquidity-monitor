# 📊 深度监控界面使用指南

## 功能概述

深度监控界面提供了订单簿深度数据的历史变化可视化功能，帮助您追踪和分析市场流动性的实时变化。

## 🎯 主要功能

### 1. **双视图切换**
- **📊 流动性概览**：原有的流动性数据表格视图
- **📈 深度变化**：全新的深度历史数据可视化界面

### 2. **订阅管理**
- ✅ 查看所有活跃的订单簿订阅
- ✅ 添加新的交易对订阅
- ✅ 移除不需要的订阅
- ✅ 实时显示订阅状态和更新时间

### 3. **深度变化图表**

#### 📊 三种图表类型

**① 深度图表**
- 显示买盘深度（绿色）和卖盘深度（红色）的堆叠面积图
- 直观展示流动性分布
- Y轴显示深度总额（USDT）

**② 价差图表**
- 显示最佳买价和卖价之间的价差百分比
- 价差越小，市场流动性越好
- 黄色线条追踪价差变化

**③ 不平衡图表**
- 显示买卖盘深度的不平衡程度
- 正值：买盘更深（看涨）
- 负值：卖盘更深（看跌）
- 紫色线条，中线为 0

#### ⏱️ 四种时间范围
- **15分钟**：超短期分析（100个数据点）
- **1小时**：短期分析（200个数据点）
- **6小时**：中期分析（500个数据点）
- **24小时**：长期分析（500个数据点）

### 4. **统计信息**
- **核心数据点**：核心指标的历史记录数量
- **高级数据点**：高级指标的历史记录数量
- **最早/最新记录**：数据时间范围
- **实时更新**：每10秒自动刷新图表

## 🚀 使用步骤

### 1. 启动系统

```bash
# 确保后端和前端都在运行
cd /Users/hakeen.yang/Desktop/gadget/Binance_liquidity

# 启动后端（终端1）
cd backend
npm start

# 启动前端（终端2）
cd frontend
npm run dev
```

### 2. 访问深度监控

1. 打开浏览器访问 `http://localhost:5173`
2. 点击顶部的 **📈 深度变化** 标签页
3. 等待加载订阅列表

### 3. 订阅交易对

**方法1：使用已有订阅**
- 左侧面板显示所有已订阅的交易对
- 点击任意交易对查看其深度变化图表

**方法2：添加新订阅**
1. 在左侧顶部输入框输入交易对符号（如：`ETHUSDT`）
2. 点击 **+ 订阅** 按钮
3. 等待订阅成功后自动显示图表

### 4. 分析深度变化

1. **选择时间范围**：根据分析需求选择 15m/1h/6h/24h
2. **切换图表类型**：
   - 查看总深度 → 选择"📊 深度"
   - 分析价差 → 选择"📈 价差"
   - 观察买卖压力 → 选择"⚖️ 不平衡"
3. **查看统计**：底部显示数据点数量和更新时间

### 5. 移除订阅

- 在左侧订阅列表中，点击交易对右侧的 **✕** 按钮
- 确认后即可移除订阅

## 📈 数据说明

### 数据来源
- **WebSocket 实时推送**：100ms 级别的订单簿增量更新
- **Redis 时间序列**：历史数据自动保存
- **更新频率**：
  - 核心指标：每 30 秒保存一次
  - 高级指标：每 5 分钟保存一次

### 深度计算
- **买盘深度**：所有买单的总价值（价格 × 数量）
- **卖盘深度**：所有卖单的总价值（价格 × 数量）
- **总深度**：买盘深度 + 卖盘深度

### 图表特性
- ✅ **实时更新**：每 10 秒自动刷新
- ✅ **响应式设计**：自动适配不同屏幕尺寸
- ✅ **交互式提示**：鼠标悬停显示详细数据
- ✅ **平滑动画**：数据变化平滑过渡

## 💡 使用技巧

### 流动性分析
1. **深度图表**查看总流动性趋势
2. **价差图表**评估市场效率
3. **不平衡图表**判断市场情绪

### 交易时机
- 深度增加 + 价差缩小 = 好的交易时机
- 深度减少 + 价差扩大 = 避免大额交易
- 买盘不平衡 > 0.2 = 强烈看涨信号
- 卖盘不平衡 < -0.2 = 强烈看跌信号

### 对比分析
- 同时订阅多个交易对
- 切换查看不同交易对的深度变化
- 对比不同币种的流动性特征

## 🎨 界面说明

### 颜色标识
- 🟢 **绿色**：买盘、现货市场
- 🔴 **红色**：卖盘
- 🟡 **黄色**：价差
- 🟣 **紫色**：不平衡度
- 🟠 **橙色**：永续合约

### 状态指示
- **🟢 实时**：数据来自 WebSocket 实时推送
- **订阅数量**：当前活跃订阅的数量
- **数据点数**：可用的历史记录数量

## ⚠️ 注意事项

### 数据限制
- 历史数据需要系统运行一段时间后才会积累
- 首次订阅需要等待 1-2 分钟才有数据
- 时间序列数据保存在 Redis 中，服务器重启不会丢失

### 性能优化
- 建议订阅数量不超过 20 个
- 长时间运行可自动清理旧数据
- 图表自动限制数据点数量以保证流畅性

### WebSocket 连接
- 订阅会自动建立 WebSocket 连接
- 连接断开会自动重连
- 取消订阅会自动关闭连接

## 🔧 故障排除

### 图表显示"暂无历史数据"
**原因**：系统刚启动，还未收集到足够数据
**解决**：等待 1-2 分钟后刷新页面

### 图表不更新
**原因**：WebSocket 连接可能断开
**解决**：
1. 检查后端服务是否运行
2. 查看浏览器控制台是否有错误
3. 尝试取消订阅后重新订阅

### 订阅失败
**原因**：交易对不存在或格式错误
**解决**：
1. 确保交易对以 `USDT` 结尾
2. 使用大写字母（如：`BTCUSDT`）
3. 检查交易对在 Binance 是否存在

### Redis 连接错误
**原因**：Redis 服务未启动
**解决**：
```bash
# macOS
brew services start redis

# Linux
sudo systemctl start redis
```

## 📊 最佳实践

1. **长期监控**：保持系统持续运行以积累历史数据
2. **多周期分析**：结合不同时间范围进行综合分析
3. **对比验证**：同时查看多个相关交易对
4. **定期维护**：定期清理不需要的订阅以优化性能

## 🎯 高级功能（未来扩展）

- [ ] 深度热力图
- [ ] 大单追踪
- [ ] 异常波动警报
- [ ] 自定义指标叠加
- [ ] 数据导出功能
- [ ] 多交易对对比视图

---

**开发者**: Cursor AI Assistant  
**版本**: 1.0.0  
**更新日期**: 2025-11-11

